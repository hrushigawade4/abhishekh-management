<h2 style="margin-bottom: 1rem;">📋 Bhakt Status</h2>

<div style="margin-bottom: 1rem;">
  <input
    type="text"
    placeholder="🔍 Search by name or mobile"
    oninput="filterBhaktList(this.value)"
    style="padding: 8px 12px; width: 300px; border-radius: 6px; border: 1px solid #ccc;"
  />
</div>

<table id="bhaktTable" style="width: 100%; border-collapse: collapse; font-family: sans-serif;">
  <thead>
    <tr style="background-color: #f0f0f0; text-align: left;">
      <th style="padding: 10px;">Name</th>
      <th style="padding: 10px;">Mobile</th>
      <th style="padding: 10px;">Abhishek Types</th>
      <th style="padding: 10px;">Start Date</th>
      <th style="padding: 10px;">Validity</th>
      <th style="padding: 10px;">Status</th>
    </tr>
  </thead>
  <tbody>
    {% for b in bhakts %}
    <tr style="border-top: 1px solid #eee;">
      <td style="padding: 10px;">{{ b.name }}</td>
      <td style="padding: 10px;">{{ b.mobile_number }}</td>
      <td style="padding: 10px;">{{ b.abhishek_types }}</td>
      <td style="padding: 10px;">{{ b.start_date.strftime('%Y-%m-%d') }}</td>
      <td style="padding: 10px;">{{ b.validity_months }} months</td>
      <td style="padding: 10px; font-weight: bold; color: {% if b.expiration_date >= current_date %}green{% else %}red{% endif %};">
        {% if b.expiration_date >= current_date %}
          Active
        {% else %}
          Inactive
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
function filterBhaktList(query) {
  query = query.toLowerCase();
  const rows = document.querySelectorAll("#bhaktTable tbody tr");

  rows.forEach(row => {
    const name = row.cells[0].textContent.toLowerCase();
    const mobile = row.cells[1].textContent.toLowerCase();
    row.style.display = (name.includes(query) || mobile.includes(query)) ? "" : "none";
  });
}
</script>
